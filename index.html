<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ù†Ø¸Ø§Ù… Web OCR Ø§Ù„Ø°ÙƒÙŠ</title>
  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      background: #f2f2f2;
      text-align: center;
      padding: 20px;
      direction: rtl;
    }
    h1 {
      color: #2c3e50;
    }
    select, input[type="file"] {
      margin: 10px;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    #result {
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      margin-top: 20px;
      text-align: right;
    }
  </style>

  <!-- Ù…ÙƒØªØ¨Ø© OCR -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.5/dist/tesseract.min.js"></script>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-database-compat.js"></script>
</head>
<body>
  <h1>ğŸ” Ù†Ø¸Ø§Ù… Web OCR Ø§Ù„Ø°ÙƒÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø£Ù„Ø¹Ø§Ø¨ Linebet / 1xBet</h1>

  <label for="gameSelect">Ø§Ø®ØªØ± Ø§Ù„Ù„Ø¹Ø¨Ø©:</label>
  <select id="gameSelect">
    <optgroup label="ğŸ¯ Crash Games">
      <option value="Aviator">Aviator</option>
      <option value="JetX">JetX</option>
      <option value="Zeppelin">Zeppelin</option>
      <option value="Crash X">Crash X</option>
    </optgroup>
    <optgroup label="ğŸ’£ Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø£Ù„ØºØ§Ù…">
      <option value="Mines">Mines</option>
      <option value="Safe Box">Safe Box</option>
      <option value="Gold Mines">Gold Mines</option>
    </optgroup>
    <optgroup label="ğŸ¡ Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø¹Ø¬Ù„Ø©">
      <option value="Wheel of Fortune">Wheel of Fortune</option>
      <option value="Mega Wheel">Mega Wheel</option>
      <option value="Spaceman">Spaceman</option>
    </optgroup>
    <optgroup label="ğŸ° ÙƒØ§Ø²ÙŠÙ†Ùˆ">
      <option value="Blackjack">Blackjack</option>
      <option value="Andar Bahar">Andar Bahar</option>
      <option value="Teen Patti">Teen Patti</option>
      <option value="Baccarat">Baccarat</option>
      <option value="Dragon Tiger">Dragon Tiger</option>
    </optgroup>
    <optgroup label="ğŸ² Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ù†Ø±Ø¯">
      <option value="Dice">Dice</option>
      <option value="HiLo">HiLo</option>
      <option value="Sic Bo">Sic Bo</option>
    </optgroup>
    <optgroup label="ğŸ§± Ø£Ù„Ø¹Ø§Ø¨ Plinko">
      <option value="Plinko Classic">Plinko Classic</option>
      <option value="Plinko X">Plinko X</option>
    </optgroup>
    <optgroup label="ğŸ Ø³Ø¨Ø§Ù‚Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©">
      <option value="Horse Racing">Horse Racing</option>
      <option value="Dog Racing">Dog Racing</option>
    </optgroup>
    <optgroup label="âš½ Ø±ÙŠØ§Ø¶Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©">
      <option value="Virtual Football">Virtual Football</option>
      <option value="Virtual Tennis">Virtual Tennis</option>
    </optgroup>
    <optgroup label="ğŸ® Ø£Ù„Ø¹Ø§Ø¨ Ù…ØµØºØ±Ø©">
      <option value="777">777</option>
      <option value="XO">XO</option>
      <option value="Fruit Blast">Fruit Blast</option>
    </optgroup>
    <optgroup label="ğŸ§  Ø£Ø®Ø±Ù‰">
      <option value="Crash X">Crash X</option>
      <option value="Penalty Shootout">Penalty Shootout</option>
      <option value="Goal">Goal</option>
      <option value="Rock Paper Scissors">Rock Paper Scissors</option>
    </optgroup>
  </select>

  <br/>
  <input type="file" id="imageInput" accept="image/*" />
  <div id="result">ğŸ“„ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§...</div>

  <script>
    // Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyCijdq8Ji8L9e3dGoHK72LaAUWsz_e5V6Y",
      authDomain: "web-ocr-ai.firebaseapp.com",
      projectId: "web-ocr-ai",
      storageBucket: "web-ocr-ai.appspot.com",
      messagingSenderId: "847993614836",
      appId: "1:847993614836:web:a2b6e91c94426dd01549a1",
      measurementId: "G-TTQZPVWFL4"
    };
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„Ø°ÙƒÙŠØ© Ù„ÙƒÙ„ Ù„Ø¹Ø¨Ø©
    function analyzeGameText(game, text) {
      let recommendation = "ğŸ§  Ø¬Ø§Ø±ÙŠ ØªØ·ÙˆÙŠØ± Ø§Ù„ØªÙˆØµÙŠØ§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù„Ø¹Ø¨Ø©...";
      const lowerText = text.toLowerCase();

      // Crash Games
      if (["Aviator","JetX","Zeppelin","Crash X"].includes(game)) {
        const matches = lowerText.match(/(\d+(\.\d+)?)[xÃ—]/g);
        if (matches && matches.length > 3) {
          const last = parseFloat(matches.pop());
          const avg = matches.slice(-5).reduce((s,v) => s + parseFloat(v), 0) / Math.min(matches.length,5);
          if (last < 1.5) recommendation = 'ğŸ”» Ù…ÙˆØ¬Ø© Ù…Ù†Ø®ÙØ¶Ø©ØŒ Ø§Ù†ØªØ¸Ø± Ù‚ÙØ²Ø§Øª Ø£Ø¹Ù„Ù‰.';
          else if (avg > 2.0) recommendation = 'ğŸš€ Ù…ØªÙˆØ³Ø· Ù…Ø±ØªÙØ¹ØŒ Ø¬ÙˆÙ„Ø© Ø¨Ù…Ø¶Ø§Ø¹Ù Ù…ØªÙˆØ³Ø· Ù…Ù†Ø§Ø³Ø¨Ø©.';
          else recommendation = 'â³ Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù‚Ù„ÙŠÙ„Ø§Ù‹.';
        } else {
          recommendation = 'ğŸ“Š Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ÙƒØ§ÙÙŠØ© Ù„Ù„ØªÙˆØµÙŠØ©.';
        }
      }
      // Mines Games
      else if (["Mines","Safe Box","Gold Mines"].includes(game)) {
        const bombs = lowerText.match(/\b[0-9]{1,2}\b/g) || [];
        if (bombs.length > 5) {
          const safeCount = bombs.filter(n=>parseInt(n)<=3).length;
          recommendation = safeCount>=3
            ? 'âœ… Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø§Ù„Ø²ÙˆØ§ÙŠØ§.'
            : 'âš ï¸ Ø¬Ø±Ø¨ Ù†Ù…Ø· 2-2-1 Ù…Ù† Ø§Ù„ÙˆØ³Ø·.';
        } else recommendation = 'ğŸ“„ ÙˆÙØ± Ù„Ù‚Ø·Ø© Ø¨Ù†ØµØ§Ø¦Ø­ Ø£ÙƒØ«Ø±.';
      }
      // Wheel Games
      else if (["Wheel of Fortune","Mega Wheel","Spaceman"].includes(game)) {
        const highs = lowerText.match(/\b(40|50|100)\b/g);
        recommendation = highs && highs.length>0
          ? 'ğŸ” Ø¬ÙˆØ§Ø¦Ø² ÙƒØ¨ÙŠØ±Ø©ØŒ Ø§Ù†ØªØ¸Ø± Ø¯ÙˆØ±Ø©.'
          : 'ğŸ’« ÙØ±ØµØ© Ù„Ø±Ø¨Ø­ Ø§Ù„Ø¢Ù†.';
      }
      // Casino Games
      else if (game==="Blackjack") {
        if (lowerText.includes("21")||lowerText.includes("blackjack"))
          recommendation = 'ğŸƒ Ø§Ù‚ØªØ±Ø¨Øª Ù…Ù† 21ØŒ ØªÙˆÙ‚Ù Ø¹Ù† Ø§Ù„Ø³Ø­Ø¨.';
        else if (lowerText.includes("bust"))
          recommendation = 'ğŸ’¥ ØªØ¬Ø§ÙˆØ²Øª 21ØŒ Ø§Ù†ØªØ¨Ù‡ Ù„Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©.';
        else recommendation = 'ğŸ“ˆ Ø¬Ø±Ø¨ Ø¬ÙˆÙ„Ø© Ø®ÙÙŠÙØ©ØŒ Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø£ÙˆØ±Ø§Ù‚.';
      }
      else if (["Andar Bahar","Teen Patti","Baccarat","Dragon Tiger"].includes(game)) {
        recommendation = 'ğŸ§  ÙŠÙØ­Ù„Ù‘ÙÙ„ Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù„Ø¹Ø¨ Ø§Ù„Ù…ØªÙƒØ±Ø±Ø©.';
      }
      // Dice Games
      else if (["Dice","HiLo","Sic Bo"].includes(game)) {
        const nums = lowerText.match(/\b\d{1,2}\b/g) || [];
        if (nums.length>=3) {
          const avg = nums.slice(-3).reduce((a,b)=>a+parseInt(b),0)/3;
          recommendation = avg>50
            ? 'ğŸ² Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¹Ø§Ù„ÙŠØ©ØŒ Ø­Ø§ÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ù†Ø®ÙØ¶.'
            : 'ğŸ² Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù…Ù†Ø®ÙØ¶Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±ØªÙØ¹.';
        } else recommendation = 'ğŸ“Š ØºÙŠØ± ÙƒØ§ÙÙ Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Ø±Ø¯.';
      }
      // Plinko Games
      else if (["Plinko Classic","Plinko X"].includes(game)) {
        recommendation = lowerText.includes("risk")
          ? 'ğŸ”» Ù…Ø®Ø§Ø·Ø±Ø© Ù…Ø±ØªÙØ¹Ø©ØŒ Ø§Ø®ØªØ± Ù…ØªÙˆØ³Ø·.'
          : 'ğŸ§± Ø¬Ø±Ø¨ Ù…Ø³Ø§Ø± Ù…Ø§Ø¦Ù„ Ù„ÙØ±ØµØ© Ø£ÙØ¶Ù„.';
      }
      // Racing Games
      else if (["Horse Racing","Dog Racing"].includes(game)) {
        recommendation = 'ğŸ Ù…Ø­Ù„Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ± Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø³Ø¨Ø§Ù‚Ø§Øª.';
      }
      // Virtual Sports
      else if (["Virtual Football","Virtual Tennis"].includes(game)) {
        recommendation = 'âš½ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ù…Ù‚Ø¯Ù… Ù„Ø§Ø­Ù‚Ø§Ù‹.';
      }
      // Mini Games
      else if (["777","XO","Fruit Blast"].includes(game)) {
        recommendation = lowerText.includes("win")||lowerText.includes("Ø±Ø¨Ø­Øª")
          ? 'ğŸ’ ÙÙˆØ² Ù…Ø¤Ø®Ø±ØŒ ÙØ±ØµØ© Ø¶Ø¦ÙŠÙ„Ø© Ø§Ù„Ø¢Ù†.'
          : 'ğŸ€ Ù„Ù… ÙŠÙØ² Ø£Ø­Ø¯ØŒ Ø¬Ø±Ø¨ Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©.';
      }
      // Other Games
      else if (game==="Penalty Shootout") {
        recommendation = 'ğŸ¥… Ø­Ø§ÙˆÙ„ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ø£Ù‚Ù„ Ø¸Ù‡ÙˆØ±Ø§Ù‹.';
      }
      else if (game==="Goal") {
        recommendation = 'âš½ Ø§Ø®ØªØ± Ø²Ø§ÙˆÙŠØ© Ù…Ø®ØªÙ„ÙØ© Ù„Ù„Ù‡Ø¯Ù.';
      }
      else if (game==="Rock Paper Scissors") {
        recommendation = 'âœŠğŸ“„âœŒï¸ ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø±ØŒ ØºÙŠÙ‘Ø± Ø§Ø®ØªÙŠØ§Ø±Ùƒ.';
      }

      return recommendation;
    }

    // OCR + ØªØ­Ù„ÙŠÙ„
    document.getElementById('imageInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      const game = document.getElementById('gameSelect').value;
      const resultDiv = document.getElementById('result');
      if (!file) return;

      resultDiv.innerHTML = "â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©...";
      Tesseract.recognize(file, 'ara', { logger: m=>console.log(m) })
      .then(({ data: { text } }) => {
        const rec = analyzeGameText(game, text);
        resultDiv.innerHTML = `
          <b>ğŸ® Ø§Ù„Ù„Ø¹Ø¨Ø©:</b> ${game}<br>
          <b>ğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬:</b><br>${text}<hr>
          <b>ğŸ¤– Ø§Ù„ØªÙˆØµÙŠØ© Ø§Ù„Ø°ÙƒÙŠØ©:</b><br>${rec}
        `;
        // Ø­ÙØ¸ ÙÙŠ Firebase
        const ts = Date.now();
        database.ref('ocr-results/'+ts).set({
          game, text, recommendation: rec, time: new Date().toLocaleString()
        });
      })
      .catch(err => {
        resultDiv.innerHTML = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„.";
        console.error(err);
      });
    });
  </script>
</body>
</html>
