<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ù†Ø¸Ø§Ù… Web OCR Ø§Ù„Ø°ÙƒÙŠ</title>
  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      background: #f2f2f2;
      text-align: center;
      padding: 20px;
    }
    h1 {
      color: #2c3e50;
    }
    select, input[type="file"] {
      margin: 10px;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    #result {
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      margin-top: 20px;
      direction: rtl;
    }
  </style>

  <!-- Ù…ÙƒØªØ¨Ø© OCR -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.5/dist/tesseract.min.js"></script>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-database-compat.js"></script>
</head>
<body>
  <h1>ğŸ” Ù†Ø¸Ø§Ù… Web OCR Ø§Ù„Ø°ÙƒÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø£Ù„Ø¹Ø§Ø¨ Linebet / 1xBet</h1>

  <label for="gameSelect">Ø§Ø®ØªØ± Ø§Ù„Ù„Ø¹Ø¨Ø©:</label>
  <select id="gameSelect">
    <!-- Ù†ÙØ³ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª ÙƒÙ…Ø§ Ù‡ÙŠ -->
    <optgroup label="ğŸ¯ Crash Games">
      <option value="Aviator">Aviator</option>
      <option value="JetX">JetX</option>
      <option value="Zeppelin">Zeppelin</option>
    </optgroup>
    <optgroup label="ğŸ’£ Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø£Ù„ØºØ§Ù…">
      <option value="Mines">Mines</option>
      <option value="Safe Box">Safe Box</option>
      <option value="Gold Mines">Gold Mines</option>
    </optgroup>
    <optgroup label="ğŸ¡ Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø¹Ø¬Ù„Ø©">
      <option value="Wheel of Fortune">Wheel of Fortune</option>
      <option value="Mega Wheel">Mega Wheel</option>
      <option value="Spaceman">Spaceman</option>
    </optgroup>
    <optgroup label="ğŸ° ÙƒØ§Ø²ÙŠÙ†Ùˆ">
      <option value="Blackjack">Blackjack</option>
      <option value="Andar Bahar">Andar Bahar</option>
      <option value="Teen Patti">Teen Patti</option>
      <option value="Baccarat">Baccarat</option>
      <option value="Dragon Tiger">Dragon Tiger</option>
    </optgroup>
    <optgroup label="ğŸ² Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ù†Ø±Ø¯">
      <option value="Dice">Dice</option>
      <option value="HiLo">HiLo</option>
      <option value="Sic Bo">Sic Bo</option>
    </optgroup>
    <optgroup label="ğŸ§± Ø£Ù„Ø¹Ø§Ø¨ Plinko">
      <option value="Plinko Classic">Plinko Classic</option>
      <option value="Plinko X">Plinko X</option>
    </optgroup>
    <optgroup label="ğŸ Ø³Ø¨Ø§Ù‚Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©">
      <option value="Horse Racing">Horse Racing</option>
      <option value="Dog Racing">Dog Racing</option>
    </optgroup>
    <optgroup label="âš½ Ø±ÙŠØ§Ø¶Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©">
      <option value="Virtual Football">Virtual Football</option>
      <option value="Virtual Tennis">Virtual Tennis</option>
    </optgroup>
    <optgroup label="ğŸ® Ø£Ù„Ø¹Ø§Ø¨ Ù…ØµØºØ±Ø©">
      <option value="777">777</option>
      <option value="XO">XO</option>
      <option value="Fruit Blast">Fruit Blast</option>
    </optgroup>
    <optgroup label="ğŸ§  Ø£Ø®Ø±Ù‰">
      <option value="Crash X">Crash X</option>
      <option value="Penalty Shootout">Penalty Shootout</option>
      <option value="Goal">Goal</option>
      <option value="Rock Paper Scissors">Rock Paper Scissors</option>
    </optgroup>
  </select>

  <br/>
  <input type="file" id="imageInput" accept="image/*" />
  <div id="result">ğŸ“„ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§...</div>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCijdq8Ji8L9e3dGoHK72LaAUWsz_e5V6Y",
      authDomain: "web-ocr-ai.firebaseapp.com",
      projectId: "web-ocr-ai",
      storageBucket: "web-ocr-ai.appspot.com",
      messagingSenderId: "847993614836",
      appId: "1:847993614836:web:a2b6e91c94426dd01549a1",
      measurementId: "G-TTQZPVWFL4"
    };
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // âœ… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ Ø¨Ø¹Ø¯ OCR
    function analyzeGameText(game, text) {
      let recommendation = "ğŸ§  Ø¬Ø§Ø±ÙŠ ØªØ·ÙˆÙŠØ± Ø§Ù„ØªÙˆØµÙŠØ§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù„Ø¹Ø¨Ø©...";
      const lowerText = text.toLowerCase();

      if (game === "Aviator") {
        const matches = lowerText.match(/(\d+(\.\d+)?)(x)/g);
        if (matches && matches.length > 3) {
          const last = parseFloat(matches[matches.length - 1]);
          const prev = parseFloat(matches[matches.length - 2]);
          const trend = last > prev ? "ØªØµØ§Ø¹Ø¯ÙŠ ğŸ”º" : "ØªÙ†Ø§Ø²Ù„ÙŠ ğŸ”»";
          recommendation = `ğŸ“ˆ Ø§Ù„Ù†Ù…Ø· Ø§Ù„Ø­Ø§Ù„ÙŠ: ${trend}<br>ğŸ¯ Ø§Ù„ØªÙˆØµÙŠØ©: Ø§Ù†ØªØ¸Ø± Ù…Ø¶Ø§Ø¹ÙØ© Ù…Ø±ØªÙØ¹Ø© Ø«Ù… Ø§Ø¯Ø®Ù„ Ø¨Ù‚ÙŠÙ…Ø© ØµØºÙŠØ±Ø©.`;
        }
      }

      else if (game === "Mines") {
        if (lowerText.includes("bomb") || lowerText.includes("mine")) {
          recommendation = "ğŸ’£ Ø§Ù„Ù„Ø¹Ø¨Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ù„ØºØ§Ù… â€” Ø¬Ø±Ø¨ Ø§Ù„Ù†Ù‚Ø± Ù…Ù† Ø§Ù„Ù…Ù†ØªØµÙ Ø£ÙˆÙ„Ù‹Ø§.";
        }
      }

      else if (game === "Dice") {
        const numbers = text.match(/\b\d+\b/g);
        if (numbers && numbers.length > 4) {
          const avg = numbers.reduce((a, b) => a + parseInt(b), 0) / numbers.length;
          recommendation = avg > 50 ? "ğŸ² Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù…Ø±ØªÙØ¹Ø© â€” Ø¬Ø±Ø¨ Ø§Ù„Ø¹Ø¨ Ø¹Ù„Ù‰ +50." : "ğŸ² Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù…Ù†Ø®ÙØ¶Ø© â€” Ø¬Ø±Ø¨ Ø§Ù„Ø¹Ø¨ Ø¹Ù„Ù‰ -50.";
        }
      }

      // Ø£Ù„Ø¹Ø§Ø¨ Ø£Ø®Ø±Ù‰ ÙŠÙ…ÙƒÙ† ØªØ·ÙˆÙŠØ± ØªØ­Ù„ÙŠÙ„Ù‡Ø§ Ù„Ø§Ø­Ù‚Ù‹Ø§
      return recommendation;
    }

    // OCR ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„
    document.getElementById('imageInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      const game = document.getElementById('gameSelect').value;
      const resultDiv = document.getElementById('result');

      if (!file) return;

      resultDiv.innerHTML = "â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©...";

      Tesseract.recognize(
        file,
        'ara', // Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
        {
          logger: m => console.log(m)
        }
      ).then(({ data: { text } }) => {
        const timestamp = Date.now();
        const recommendation = analyzeGameText(game, text);

        resultDiv.innerHTML = `
          <b>ğŸ® Ø§Ù„Ù„Ø¹Ø¨Ø©:</b> ${game}<br>
          <b>ğŸ“„ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬:</b><br>${text}<hr>
          <b>ğŸ¤– Ø§Ù„ØªÙˆØµÙŠØ© Ø§Ù„Ø°ÙƒÙŠØ©:</b><br>${recommendation}
        `;

        database.ref('ocr-results/' + timestamp).set({
          game: game,
          text: text,
          recommendation: recommendation,
          time: new Date().toLocaleString()
        });
      }).catch(err => {
        resultDiv.innerHTML = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„.";
        console.error(err);
      });
    });
  </script>
</body>
</html>
